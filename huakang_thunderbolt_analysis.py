#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
华康洁净暴雷事件深度分析
实控人减持可转债的重大利空影响
"""

import json
from datetime import datetime

class HuakangThunderboltAnalysis:
    """华康洁净暴雷事件分析"""
    
    def __init__(self):
        self.stock_code = '301235.SZ'
        self.stock_name = '华康洁净'
        self.analysis_time = datetime.now()
        
    def analyze_convertible_bond_reduction(self):
        """分析实控人减持可转债事件"""
        print("⚡ 华康洁净重大暴雷事件分析")
        print("=" * 60)
        print("📅 事件时间: 2025年7月30日-31日")
        print("🚨 事件性质: 实控人大幅减持可转债")
        
        print("\n📊 减持详情:")
        print("-" * 40)
        print("👤 减持主体: 谭平涛(实际控制人)")
        print("💰 减持标的: 华医转债(123251)")
        print("📈 减持数量: 996,710张")
        print("📊 减持比例: 13.29%(占发行总量)")
        print("💵 减持金额: 约9967万元(按面值计算)")
        
        print("\n🔍 事件严重性分析:")
        print("-" * 40)
        
        severity_factors = [
            "实控人身份 - 最了解公司内情的人",
            "减持规模巨大 - 13.29%发行总量",
            "时间敏感 - 可转债刚满6个月转股期",
            "信号意义 - 可能预示重大利空",
            "市场冲击 - 严重打击投资者信心"
        ]
        
        for i, factor in enumerate(severity_factors, 1):
            print("{}. {}".format(i, factor))
        
        print("\n⚠️ 为什么这是重大暴雷:")
        print("-" * 40)
        
        thunderbolt_reasons = [
            "实控人最了解公司真实情况，大量减持说明对未来极度悲观",
            "可转债刚到转股期就急于套现，暗示公司可能面临重大困难",
            "13.29%的减持比例巨大，不是小额套现而是战略性撤退",
            "在业绩看似良好时减持，可能知道投资者不知道的内幕",
            "时间点极其敏感，7月底恰好是中报发布期"
        ]
        
        for i, reason in enumerate(thunderbolt_reasons, 1):
            print("{}. {}".format(i, reason))
        
        return {
            "event_date": "2025-07-30至31",
            "reduction_subject": "谭平涛(实控人)",
            "reduction_amount": 996710,
            "reduction_ratio": 13.29,
            "severity_level": "极高"
        }
    
    def analyze_market_impact(self):
        """分析市场影响"""
        print("\n💥 市场冲击波分析")
        print("=" * 60)
        
        print("📊 直接影响:")
        print("-" * 30)
        direct_impacts = [
            "可转债价格承压下跌",
            "股票投资者信心崩塌", 
            "引发恐慌性抛售",
            "流动性急剧恶化",
            "估值体系重构"
        ]
        
        for impact in direct_impacts:
            print("❌ {}".format(impact))
        
        print("\n📈 技术面冲击:")
        print("-" * 30)
        technical_impacts = [
            "从35.20元高位急速下跌",
            "成交量放大，恐慌盘涌出",
            "技术形态彻底破坏",
            "支撑位全线失守",
            "可能连续跌停"
        ]
        
        for impact in technical_impacts:
            print("📉 {}".format(impact))
        
        print("\n🏛️ 机构反应:")
        print("-" * 30)
        institutional_reactions = [
            "基金经理紧急调研",
            "券商下调评级至卖出",
            "机构投资者大幅减仓",
            "分析师发布风险提示",
            "北向资金可能流出"
        ]
        
        for reaction in institutional_reactions:
            print("🚨 {}".format(reaction))
        
        return {
            "direct_impacts": direct_impacts,
            "technical_impacts": technical_impacts,
            "institutional_reactions": institutional_reactions
        }
    
    def analyze_fundamental_concerns(self):
        """分析基本面隐忧"""
        print("\n🔍 基本面深层隐忧分析")
        print("=" * 60)
        
        print("💡 实控人减持可能的内在原因:")
        print("-" * 40)
        
        fundamental_concerns = [
            "行业竞争加剧，订单获取困难加大",
            "成本上升压力，毛利率可能持续下滑", 
            "应收账款质量恶化，现金流紧张",
            "新业务拓展不及预期，增长乏力",
            "监管政策变化，对业务产生不利影响",
            "客户集中度过高，存在重大客户流失风险",
            "可能存在尚未公布的重大诉讼或纠纷",
            "管理层对公司未来发展信心不足"
        ]
        
        for i, concern in enumerate(fundamental_concerns, 1):
            print("{}. ⚠️ {}".format(i, concern))
        
        print("\n📊 财务数据质疑:")
        print("-" * 40)
        financial_questions = [
            "营收增长50.73%是否可持续？",
            "净利润增长273.48%是否有水分？",
            "现金流状况是否真实健康？",
            "资产负债率53.22%是否过高？",
            "应收账款周转是否正常？"
        ]
        
        for question in financial_questions:
            print("❓ {}".format(question))
        
        return {
            "fundamental_concerns": fundamental_concerns,
            "financial_questions": financial_questions
        }
    
    def emergency_investment_advice(self):
        """紧急投资建议"""
        print("\n🚨 紧急投资建议")
        print("=" * 60)
        
        print("🔴 投资评级: 紧急回避")
        print("⚠️ 风险等级: 极高")
        print("📊 操作建议: 立即清仓，远离该股")
        
        print("\n📋 具体操作策略:")
        print("-" * 40)
        
        emergency_actions = [
            "已持有者：立即止损离场，不要幻想反弹",
            "观望者：绝对不要抄底，等待充分调整",
            "可转债持有者：尽快卖出，避免更大损失",
            "关注者：移出自选股，寻找其他标的"
        ]
        
        for i, action in enumerate(emergency_actions, 1):
            print("{}. {}".format(i, action))
        
        print("\n⚠️ 风险提示:")
        print("-" * 40)
        
        risk_warnings = [
            "实控人减持属重大利空，影响深远",
            "股价可能出现连续跌停",
            "基本面可能存在重大隐患",
            "短期内难以修复投资者信心",
            "可能引发更多负面消息曝光"
        ]
        
        for warning in risk_warnings:
            print("❌ {}".format(warning))
        
        print("\n🤔 投资反思:")
        print("-" * 40)
        
        reflection_points = [
            "之前忽视了新闻面分析的重要性",
            "过度依赖财务数据而忽视了实控人行为",
            "没有建立完善的风险预警机制",
            "应该更加关注内幕人士的动向",
            "技术分析要结合基本面和消息面"
        ]
        
        for point in reflection_points:
            print("💭 {}".format(point))
        
        return {
            "investment_rating": "紧急回避",
            "risk_level": "极高",
            "emergency_actions": emergency_actions,
            "risk_warnings": risk_warnings,
            "reflection_points": reflection_points
        }
    
    def generate_thunderbolt_report(self):
        """生成暴雷分析报告"""
        print("\n" + "=" * 80)
        print("⚡ 华康洁净(301235.SZ)暴雷事件完整分析报告")
        print("=" * 80)
        print("📅 分析时间: {}".format(self.analysis_time.strftime('%Y-%m-%d %H:%M:%S')))
        print("🚨 事件性质: 实控人大幅减持可转债重大利空")
        print("📊 影响程度: 极其严重")
        
        # 执行各项分析
        reduction_analysis = self.analyze_convertible_bond_reduction()
        market_impact = self.analyze_market_impact()
        fundamental_concerns = self.analyze_fundamental_concerns()
        investment_advice = self.emergency_investment_advice()
        
        # 生成完整报告
        comprehensive_report = {
            "事件概述": {
                "股票代码": self.stock_code,
                "股票名称": self.stock_name,
                "事件时间": "2025年7月30日-31日",
                "事件性质": "实控人大幅减持可转债",
                "严重程度": "极其严重"
            },
            "减持分析": reduction_analysis,
            "市场影响": market_impact,
            "基本面隐忧": fundamental_concerns,
            "紧急建议": investment_advice,
            "总结": {
                "核心问题": "实控人谭平涛减持996,710张华医转债，占发行总量13.29%",
                "主要风险": "可能存在重大未披露利空，基本面可能严重恶化",
                "投资建议": "紧急回避，立即清仓",
                "后续关注": "等待公司澄清公告和进一步调整"
            },
            "分析时间": self.analysis_time.isoformat()
        }
        
        return comprehensive_report

def main():
    """主函数"""
    print("🚀 启动华康洁净暴雷事件紧急分析")
    print("⚡ 实控人减持可转债重大利空分析")
    
    analyzer = HuakangThunderboltAnalysis()
    report = analyzer.generate_thunderbolt_report()
    
    # 保存暴雷分析报告
    timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
    filename = "华康洁净_暴雷事件分析报告_{}.json".format(timestamp)
    
    with open(filename, 'w', encoding='utf-8') as f:
        json.dump(report, f, ensure_ascii=False, indent=2, default=str)
    
    print("\n💾 暴雷分析报告已保存: {}".format(filename))
    
    print("\n" + "=" * 80)
    print("💥 重要结论:")
    print("华康洁净实控人大幅减持可转债属重大暴雷事件！")
    print("之前的投资建议存在严重缺陷，未进行新闻面分析！")
    print("投资者应立即回避，等待进一步澄清！")
    print("=" * 80)

if __name__ == "__main__":
    main()