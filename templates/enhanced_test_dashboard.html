<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Trading Agent Ê∑±Â∫¶ÊµãËØïÈù¢Êùø</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 20px;
        }
        
        .system-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .status-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .status-item h4 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-left: 8px;
        }
        
        .status-online { background: #27ae60; }
        .status-offline { background: #e74c3c; }
        .status-warning { background: #f39c12; }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
        }
        
        .test-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .test-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
        }
        
        .test-card h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            font-size: 1.3em;
        }
        
        .test-card .icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: inline-block;
            margin-right: 12px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: rgba(255, 255, 255, 1);
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
            position: relative;
            overflow: hidden;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn.danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }
        
        .btn.success {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }
        
        .btn.warning {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }
        
        .btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .result-area {
            margin-top: 20px;
            padding: 20px;
            background: rgba(248, 249, 250, 0.8);
            border: 1px solid #e9ecef;
            border-radius: 8px;
            min-height: 120px;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;
            font-size: 13px;
            white-space: pre-wrap;
            line-height: 1.5;
        }
        
        .loading {
            display: none;
            text-align: center;
            color: #667eea;
            font-weight: 500;
            margin: 15px 0;
        }
        
        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #667eea;
            border-top: 2px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .analysis-depth {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .depth-option {
            padding: 10px;
            text-align: center;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
            font-weight: 500;
        }
        
        .depth-option.active {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }
        
        .feature-tag {
            display: inline-block;
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            margin: 2px;
        }
        
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .metric-item {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 8px;
        }
        
        .metric-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .metric-label {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        .footer {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: white;
            text-align: center;
            padding: 25px;
            border-radius: 15px;
            margin-top: 40px;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            .system-status {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .analysis-depth {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Enhanced Trading Agent</h1>
            <p>Ê∑±Â∫¶Â§öÊô∫ËÉΩ‰ΩìËÇ°Á•®ÂàÜÊûêÁ≥ªÁªü - ÂÆûÊó∂Êï∞ÊçÆ + AIÂçèÂêåÂÜ≥Á≠ñ</p>
            
            <!-- Á≥ªÁªüÁä∂ÊÄÅÁõëÊéß -->
            <div class="system-status">
                <div class="status-item">
                    <h4>Tushare API <span class="status-indicator status-offline" id="tushare-status"></span></h4>
                    <small>ÂÆûÊó∂Êï∞ÊçÆÊ∫ê</small>
                </div>
                <div class="status-item">
                    <h4>DashScope <span class="status-indicator status-offline" id="dashscope-status"></span></h4>
                    <small>ÂçÉÈóÆÂ§ßÊ®°Âûã</small>
                </div>
                <div class="status-item">
                    <h4>Â§öÊô∫ËÉΩ‰ΩìÁ≥ªÁªü <span class="status-indicator status-online" id="agent-status"></span></h4>
                    <small>ÂçèÂêåÂàÜÊûê</small>
                </div>
                <div class="status-item">
                    <h4>WebÊúçÂä° <span class="status-indicator status-online" id="web-status"></span></h4>
                    <small>Âú®Á∫øËøêË°å</small>
                </div>
            </div>
        </div>
        
        <div class="dashboard">
            <!-- Ê∑±Â∫¶ËÇ°Á•®ÂàÜÊûê -->
            <div class="test-card">
                <h3>
                    <span class="icon" style="background: linear-gradient(135deg, #667eea, #764ba2);"></span>
                    üß† Ê∑±Â∫¶Â§öÊô∫ËÉΩ‰ΩìÂàÜÊûê
                </h3>
                
                <div class="feature-tag">ÂÆûÊó∂Êï∞ÊçÆ</div>
                <div class="feature-tag">Â§öËΩÆËæ©ËÆ∫</div>
                <div class="feature-tag">Ëá™ÊàëÂèçÊÄù</div>
                <div class="feature-tag">È£éÈô©ËØÑ‰º∞</div>
                
                <div class="form-group">
                    <label for="deep-stock-code">ËÇ°Á•®‰ª£Á†Å</label>
                    <input type="text" id="deep-stock-code" placeholder="Â¶ÇÔºö603516, 000001, 600036" value="603516">
                </div>
                
                <div class="form-group">
                    <label>ÂàÜÊûêÊ∑±Â∫¶</label>
                    <div class="analysis-depth">
                        <div class="depth-option" data-depth="quick">Âø´ÈÄüÂàÜÊûê</div>
                        <div class="depth-option active" data-depth="standard">Ê†áÂáÜÂàÜÊûê</div>
                        <div class="depth-option" data-depth="deep">Ê∑±Â∫¶ÂàÜÊûê</div>
                        <div class="depth-option" data-depth="comprehensive">ÂÖ®Èù¢ÂàÜÊûê</div>
                    </div>
                </div>
                
                <button class="btn" onclick="runDeepAnalysis()">ÂêØÂä®Ê∑±Â∫¶ÂàÜÊûê</button>
                
                <div class="progress-bar" id="deep-progress" style="display: none;">
                    <div class="progress-fill" id="deep-progress-fill"></div>
                </div>
                
                <div class="loading" id="deep-loading">AIÊô∫ËÉΩ‰ΩìÊ≠£Âú®ÂçèÂêåÂàÜÊûê‰∏≠...</div>
                <div class="result-area" id="deep-result">ÁÇπÂáªÂêØÂä®Ê∑±Â∫¶ÂàÜÊûê</div>
            </div>
            
            <!-- ÂÆûÊó∂Êï∞ÊçÆÁõëÊéß -->
            <div class="test-card">
                <h3>
                    <span class="icon" style="background: linear-gradient(135deg, #e74c3c, #c0392b);"></span>
                    üìä ÂÆûÊó∂Êï∞ÊçÆÁõëÊéß
                </h3>
                
                <div class="feature-tag">Tushare</div>
                <div class="feature-tag">AKShare</div>
                <div class="feature-tag">ÊäÄÊúØÊåáÊ†á</div>
                
                <div class="form-group">
                    <label for="monitor-stock">ÁõëÊéßËÇ°Á•®</label>
                    <input type="text" id="monitor-stock" placeholder="ËÇ°Á•®‰ª£Á†Å" value="603516">
                </div>
                
                <div class="btn-group">
                    <button class="btn success" onclick="startRealTimeMonitor()">ÂºÄÂßãÁõëÊéß</button>
                    <button class="btn danger" onclick="stopRealTimeMonitor()">ÂÅúÊ≠¢ÁõëÊéß</button>
                </div>
                
                <div class="metric-grid" id="real-time-metrics">
                    <div class="metric-item">
                        <div class="metric-value" id="current-price">--</div>
                        <div class="metric-label">ÂΩìÂâç‰ª∑Ê†º</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="price-change">--</div>
                        <div class="metric-label">Ê∂®Ë∑åÂπÖ</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="volume">--</div>
                        <div class="metric-label">Êàê‰∫§Èáè</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="turnover">--</div>
                        <div class="metric-label">Êç¢ÊâãÁéá</div>
                    </div>
                </div>
                
                <div class="result-area" id="monitor-result">ÂÆûÊó∂Êï∞ÊçÆÂ∞ÜÂú®Ê≠§ÊòæÁ§∫</div>
            </div>
            
            <!-- Â§öÊô∫ËÉΩ‰ΩìËæ©ËÆ∫ -->
            <div class="test-card">
                <h3>
                    <span class="icon" style="background: linear-gradient(135deg, #f39c12, #e67e22);"></span>
                    üó£Ô∏è Â§öÊô∫ËÉΩ‰ΩìËæ©ËÆ∫Á≥ªÁªü
                </h3>
                
                <div class="feature-tag">Â§öÂ§¥Á†îÁ©∂Âëò</div>
                <div class="feature-tag">Á©∫Â§¥Á†îÁ©∂Âëò</div>
                <div class="feature-tag">‰∏≠ÊÄßÂàÜÊûêÂ∏à</div>
                <div class="feature-tag">È£éÈô©ÁÆ°ÁêÜÂ∏à</div>
                
                <div class="form-group">
                    <label for="debate-stock">Ëæ©ËÆ∫Ê†áÁöÑ</label>
                    <input type="text" id="debate-stock" placeholder="ËÇ°Á•®‰ª£Á†Å" value="603516">
                </div>
                
                <div class="form-group">
                    <label for="debate-rounds">Ëæ©ËÆ∫ËΩÆÊï∞</label>
                    <select id="debate-rounds">
                        <option value="1">1ËΩÆ (Âø´ÈÄü)</option>
                        <option value="2" selected>2ËΩÆ (Ê†áÂáÜ)</option>
                        <option value="3">3ËΩÆ (Ê∑±Â∫¶)</option>
                        <option value="5">5ËΩÆ (ÂÖ®Èù¢)</option>
                    </select>
                </div>
                
                <button class="btn warning" onclick="startAgentDebate()">ÂºÄÂßãÊô∫ËÉΩ‰ΩìËæ©ËÆ∫</button>
                
                <div class="loading" id="debate-loading">Êô∫ËÉΩ‰ΩìËæ©ËÆ∫ËøõË°å‰∏≠...</div>
                <div class="result-area" id="debate-result">ÁÇπÂáªÂºÄÂßãÊô∫ËÉΩ‰ΩìËæ©ËÆ∫</div>
            </div>
            
            <!-- È£éÈô©ÁÆ°ÁêÜÁ≥ªÁªü -->
            <div class="test-card">
                <h3>
                    <span class="icon" style="background: linear-gradient(135deg, #27ae60, #229954);"></span>
                    ‚ö†Ô∏è Êô∫ËÉΩÈ£éÈô©ÁÆ°ÁêÜ
                </h3>
                
                <div class="feature-tag">VaRËÆ°ÁÆó</div>
                <div class="feature-tag">ÂéãÂäõÊµãËØï</div>
                <div class="feature-tag">Áõ∏ÂÖ≥ÊÄßÂàÜÊûê</div>
                
                <div class="form-group">
                    <label for="risk-portfolio">ÊäïËµÑÁªÑÂêà</label>
                    <textarea id="risk-portfolio" placeholder="ËæìÂÖ•ËÇ°Á•®‰ª£Á†ÅÔºåÁî®ÈÄóÂè∑ÂàÜÈöîÔºåÂ¶ÇÔºö603516,000001,600036" rows="3">603516,000001,600036</textarea>
                </div>
                
                <div class="form-group">
                    <label for="risk-confidence">ÁΩÆ‰ø°Ê∞¥Âπ≥</label>
                    <select id="risk-confidence">
                        <option value="0.95" selected>95%</option>
                        <option value="0.99">99%</option>
                        <option value="0.999">99.9%</option>
                    </select>
                </div>
                
                <button class="btn success" onclick="runRiskAnalysis()">ËøêË°åÈ£éÈô©ÂàÜÊûê</button>
                
                <div class="loading" id="risk-loading">Ê≠£Âú®ËÆ°ÁÆóÈ£éÈô©ÊåáÊ†á...</div>
                <div class="result-area" id="risk-result">ÁÇπÂáªËøêË°åÈ£éÈô©ÂàÜÊûê</div>
            </div>
            
            <!-- Á≠ñÁï•ÂõûÊµãÁ≥ªÁªü -->
            <div class="test-card">
                <h3>
                    <span class="icon" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);"></span>
                    üìà Êô∫ËÉΩÁ≠ñÁï•ÂõûÊµã
                </h3>
                
                <div class="feature-tag">ÈáèÂåñÁ≠ñÁï•</div>
                <div class="feature-tag">ÂéÜÂè≤ÂõûÊµã</div>
                <div class="feature-tag">ÊÄßËÉΩËØÑ‰º∞</div>
                
                <div class="form-group">
                    <label for="backtest-strategy">Á≠ñÁï•Á±ªÂûã</label>
                    <select id="backtest-strategy">
                        <option value="multi_agent_consensus">Â§öÊô∫ËÉΩ‰ΩìÂÖ±ËØÜÁ≠ñÁï•</option>
                        <option value="deep_reasoning">Ê∑±Â∫¶Êé®ÁêÜÁ≠ñÁï•</option>
                        <option value="risk_adjusted">È£éÈô©Ë∞ÉÊï¥Á≠ñÁï•</option>
                        <option value="momentum_reversal">Âä®ÈáèÂèçËΩ¨Á≠ñÁï•</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="backtest-period">ÂõûÊµãÂë®Êúü</label>
                    <select id="backtest-period">
                        <option value="3m">3‰∏™Êúà</option>
                        <option value="6m" selected>6‰∏™Êúà</option>
                        <option value="1y">1Âπ¥</option>
                        <option value="2y">2Âπ¥</option>
                    </select>
                </div>
                
                <button class="btn" onclick="runAdvancedBacktest()">ËøêË°åÈ´òÁ∫ßÂõûÊµã</button>
                
                <div class="loading" id="backtest-loading">Ê≠£Âú®ËøêË°åÁ≠ñÁï•ÂõûÊµã...</div>
                <div class="result-area" id="backtest-result">ÁÇπÂáªËøêË°åÈ´òÁ∫ßÂõûÊµã</div>
            </div>
            
            <!-- Á≥ªÁªüËØäÊñ≠Â∑•ÂÖ∑ -->
            <div class="test-card">
                <h3>
                    <span class="icon" style="background: linear-gradient(135deg, #34495e, #2c3e50);"></span>
                    üîß Á≥ªÁªüËØäÊñ≠‰∏é‰ºòÂåñ
                </h3>
                
                <div class="btn-group">
                    <button class="btn success" onclick="systemHealthCheck()">Á≥ªÁªüÂÅ•Â∫∑Ê£ÄÊü•</button>
                    <button class="btn warning" onclick="performanceTest()">ÊÄßËÉΩÂéãÂäõÊµãËØï</button>
                </div>
                
                <div class="btn-group">
                    <button class="btn" onclick="apiConnectionTest()">APIËøûÊé•ÊµãËØï</button>
                    <button class="btn danger" onclick="clearSystemCache()">Ê∏ÖÁêÜÁ≥ªÁªüÁºìÂ≠ò</button>
                </div>
                
                <div class="loading" id="system-loading">Ê≠£Âú®ËøõË°åÁ≥ªÁªüËØäÊñ≠...</div>
                <div class="result-area" id="system-result">ÁÇπÂáªÊâßË°åÁ≥ªÁªüËØäÊñ≠</div>
            </div>
        </div>
        
        <div class="footer">
            <p>&copy; 2024 Enhanced Trading Agent | Ê∑±Â∫¶Â§öÊô∫ËÉΩ‰ΩìËÇ°Á•®ÂàÜÊûêÁ≥ªÁªü</p>
            <p>ÈõÜÊàêÂÆûÊó∂Êï∞ÊçÆ„ÄÅÊ∑±Â∫¶Êé®ÁêÜ„ÄÅÂ§öÊô∫ËÉΩ‰ΩìÂçè‰ΩúÂíåÊô∫ËÉΩÈ£éÈô©ÁÆ°ÁêÜ</p>
        </div>
    </div>

    <script>
        // ÂÖ®Â±ÄÂèòÈáè
        let currentAnalysisDepth = 'standard';
        let realTimeMonitorInterval = null;
        let systemMetrics = {
            analysisCount: 0,
            successRate: 0,
            avgResponseTime: 0,
            activeConnections: 0
        };

        // ÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            initializeSystem();
            setupEventListeners();
        });

        function initializeSystem() {
            console.log('üöÄ Enhanced Trading Agent System Initializing...');
            
            // Ê®°ÊãüAPIÁä∂ÊÄÅÊ£ÄÊü•
            setTimeout(() => {
                checkApiStatus();
            }, 1000);
            
            // Êõ¥Êñ∞Á≥ªÁªüÊåáÊ†á
            updateSystemMetrics();
            setInterval(updateSystemMetrics, 5000);
        }

        function setupEventListeners() {
            // ÂàÜÊûêÊ∑±Â∫¶ÈÄâÊã©
            document.querySelectorAll('.depth-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.depth-option').forEach(o => o.classList.remove('active'));
                    this.classList.add('active');
                    currentAnalysisDepth = this.dataset.depth;
                });
            });
        }

        // APIÁä∂ÊÄÅÊ£ÄÊü•
        async function checkApiStatus() {
            const apis = ['tushare', 'dashscope', 'agent', 'web'];
            
            for (const api of apis) {
                const indicator = document.getElementById(`${api}-status`);
                const isOnline = Math.random() > 0.3; // Ê®°ÊãüËøûÊé•Áä∂ÊÄÅ
                
                if (indicator) {
                    indicator.className = `status-indicator ${isOnline ? 'status-online' : 'status-offline'}`;
                }
            }
        }

        // Ê∑±Â∫¶ÂàÜÊûê
        async function runDeepAnalysis() {
            const stockCode = document.getElementById('deep-stock-code').value;
            if (!stockCode) {
                alert('ËØ∑ËæìÂÖ•ËÇ°Á•®‰ª£Á†Å');
                return;
            }

            showLoading('deep-loading', 'deep-result');
            showProgress('deep-progress', 'deep-progress-fill');

            try {
                // Ê®°ÊãüÊ∑±Â∫¶ÂàÜÊûêËøáÁ®ã
                const stages = [
                    { name: 'Êî∂ÈõÜÂÆûÊó∂Êï∞ÊçÆ', progress: 20 },
                    { name: 'ÊäÄÊúØÊåáÊ†áËÆ°ÁÆó', progress: 40 },
                    { name: 'Â§öÊô∫ËÉΩ‰ΩìÂçèÂïÜ', progress: 60 },
                    { name: 'È£éÈô©ËØÑ‰º∞ÂàÜÊûê', progress: 80 },
                    { name: 'ÁîüÊàêÊúÄÁªàÊä•Âëä', progress: 100 }
                ];

                for (const stage of stages) {
                    updateProgress('deep-progress-fill', stage.progress);
                    document.getElementById('deep-loading').textContent = `${stage.name}...`;
                    await sleep(1000);
                }

                const result = await mockDeepAnalysis(stockCode, currentAnalysisDepth);
                showResult('deep-result', result);
                systemMetrics.analysisCount++;

            } catch (error) {
                showResult('deep-result', { error: error.message });
            } finally {
                hideLoading('deep-loading');
                hideProgress('deep-progress');
            }
        }

        // ÂÆûÊó∂ÁõëÊéß
        function startRealTimeMonitor() {
            const stockCode = document.getElementById('monitor-stock').value;
            if (!stockCode) {
                alert('ËØ∑ËæìÂÖ•ËÇ°Á•®‰ª£Á†Å');
                return;
            }

            if (realTimeMonitorInterval) {
                clearInterval(realTimeMonitorInterval);
            }

            realTimeMonitorInterval = setInterval(() => {
                updateRealTimeData(stockCode);
            }, 2000);

            document.getElementById('monitor-result').textContent = `Ê≠£Âú®ÁõëÊéß ${stockCode} ÁöÑÂÆûÊó∂Êï∞ÊçÆ...`;
            updateRealTimeData(stockCode);
        }

        function stopRealTimeMonitor() {
            if (realTimeMonitorInterval) {
                clearInterval(realTimeMonitorInterval);
                realTimeMonitorInterval = null;
            }
            document.getElementById('monitor-result').textContent = 'ÂÆûÊó∂ÁõëÊéßÂ∑≤ÂÅúÊ≠¢';
        }

        function updateRealTimeData(stockCode) {
            // Ê®°ÊãüÂÆûÊó∂Êï∞ÊçÆ
            const mockData = {
                price: (Math.random() * 100 + 50).toFixed(2),
                change: ((Math.random() - 0.5) * 10).toFixed(2),
                volume: (Math.random() * 1000000).toFixed(0),
                turnover: (Math.random() * 10).toFixed(2)
            };

            document.getElementById('current-price').textContent = mockData.price;
            document.getElementById('price-change').textContent = mockData.change + '%';
            document.getElementById('volume').textContent = mockData.volume;
            document.getElementById('turnover').textContent = mockData.turnover + '%';

            // Êõ¥Êñ∞ÁªìÊûúÂå∫Âüü
            const timestamp = new Date().toLocaleTimeString();
            const resultText = `[${timestamp}] ${stockCode}: ¬•${mockData.price} (${mockData.change}%)\n`;
            document.getElementById('monitor-result').textContent += resultText;
        }

        // Êô∫ËÉΩ‰ΩìËæ©ËÆ∫
        async function startAgentDebate() {
            const stockCode = document.getElementById('debate-stock').value;
            const rounds = document.getElementById('debate-rounds').value;

            if (!stockCode) {
                alert('ËØ∑ËæìÂÖ•ËÇ°Á•®‰ª£Á†Å');
                return;
            }

            showLoading('debate-loading', 'debate-result');

            try {
                const result = await mockAgentDebate(stockCode, rounds);
                showResult('debate-result', result);
            } catch (error) {
                showResult('debate-result', { error: error.message });
            } finally {
                hideLoading('debate-loading');
            }
        }

        // È£éÈô©ÂàÜÊûê
        async function runRiskAnalysis() {
            const portfolio = document.getElementById('risk-portfolio').value;
            const confidence = document.getElementById('risk-confidence').value;

            if (!portfolio) {
                alert('ËØ∑ËæìÂÖ•ÊäïËµÑÁªÑÂêà');
                return;
            }

            showLoading('risk-loading', 'risk-result');

            try {
                const result = await mockRiskAnalysis(portfolio, confidence);
                showResult('risk-result', result);
            } catch (error) {
                showResult('risk-result', { error: error.message });
            } finally {
                hideLoading('risk-loading');
            }
        }

        // È´òÁ∫ßÂõûÊµã
        async function runAdvancedBacktest() {
            const strategy = document.getElementById('backtest-strategy').value;
            const period = document.getElementById('backtest-period').value;

            showLoading('backtest-loading', 'backtest-result');

            try {
                const result = await mockAdvancedBacktest(strategy, period);
                showResult('backtest-result', result);
            } catch (error) {
                showResult('backtest-result', { error: error.message });
            } finally {
                hideLoading('backtest-loading');
            }
        }

        // Á≥ªÁªüËØäÊñ≠
        async function systemHealthCheck() {
            showLoading('system-loading', 'system-result');

            try {
                const result = await mockSystemHealthCheck();
                showResult('system-result', result);
            } catch (error) {
                showResult('system-result', { error: error.message });
            } finally {
                hideLoading('system-loading');
            }
        }

        async function performanceTest() {
            showLoading('system-loading', 'system-result');

            try {
                const result = await mockPerformanceTest();
                showResult('system-result', result);
            } catch (error) {
                showResult('system-result', { error: error.message });
            } finally {
                hideLoading('system-loading');
            }
        }

        async function apiConnectionTest() {
            showLoading('system-loading', 'system-result');

            try {
                const result = await mockApiConnectionTest();
                showResult('system-result', result);
                checkApiStatus(); // Êõ¥Êñ∞Áä∂ÊÄÅÊåáÁ§∫Âô®
            } catch (error) {
                showResult('system-result', { error: error.message });
            } finally {
                hideLoading('system-loading');
            }
        }

        async function clearSystemCache() {
            showLoading('system-loading', 'system-result');

            try {
                const result = await mockClearCache();
                showResult('system-result', result);
            } catch (error) {
                showResult('system-result', { error: error.message });
            } finally {
                hideLoading('system-loading');
            }
        }

        // Â∑•ÂÖ∑ÂáΩÊï∞
        function showLoading(loadingId, resultId) {
            document.getElementById(loadingId).style.display = 'block';
            document.getElementById(resultId).textContent = '';
        }

        function hideLoading(loadingId) {
            document.getElementById(loadingId).style.display = 'none';
        }

        function showProgress(progressId, fillId) {
            document.getElementById(progressId).style.display = 'block';
            document.getElementById(fillId).style.width = '0%';
        }

        function hideProgress(progressId) {
            document.getElementById(progressId).style.display = 'none';
        }

        function updateProgress(fillId, percentage) {
            document.getElementById(fillId).style.width = percentage + '%';
        }

        function showResult(resultId, result) {
            document.getElementById(resultId).textContent = JSON.stringify(result, null, 2);
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function updateSystemMetrics() {
            systemMetrics.activeConnections = Math.floor(Math.random() * 100) + 10;
            systemMetrics.avgResponseTime = Math.floor(Math.random() * 500) + 100;
            systemMetrics.successRate = (Math.random() * 0.2 + 0.8).toFixed(3);
        }

        // Ê®°ÊãüAPIÂáΩÊï∞
        async function mockDeepAnalysis(stockCode, depth) {
            await sleep(2000);
            return {
                stock_code: stockCode,
                analysis_depth: depth,
                recommendation: ['Âº∫ÁÉà‰π∞ÂÖ•', '‰π∞ÂÖ•', 'ÊåÅÊúâ', 'ÂçñÂá∫'][Math.floor(Math.random() * 4)],
                confidence: (Math.random() * 0.4 + 0.6).toFixed(2),
                price_target: {
                    optimistic: (Math.random() * 50 + 100).toFixed(2),
                    base_case: (Math.random() * 30 + 80).toFixed(2),
                    pessimistic: (Math.random() * 20 + 60).toFixed(2)
                },
                risk_factors: [
                    'Â∏ÇÂú∫Ê≥¢Âä®È£éÈô©',
                    'Ë°å‰∏öÊîøÁ≠ñÈ£éÈô©',
                    'ÂÖ¨Âè∏ÁªèËê•È£éÈô©'
                ],
                agent_consensus: {
                    bull_score: Math.floor(Math.random() * 40 + 60),
                    bear_score: Math.floor(Math.random() * 40 + 20),
                    neutral_score: Math.floor(Math.random() * 20 + 40)
                },
                timestamp: new Date().toISOString()
            };
        }

        async function mockAgentDebate(stockCode, rounds) {
            await sleep(parseInt(rounds) * 1000);
            return {
                stock_code: stockCode,
                debate_rounds: rounds,
                participants: ['Â§öÂ§¥Á†îÁ©∂Âëò', 'Á©∫Â§¥Á†îÁ©∂Âëò', '‰∏≠ÊÄßÂàÜÊûêÂ∏à', 'È£éÈô©ÁÆ°ÁêÜÂ∏à'],
                final_consensus: {
                    recommendation: 'Ë∞®ÊÖé‰π∞ÂÖ•',
                    confidence: 0.72,
                    key_arguments: [
                        'ÊäÄÊúØÈù¢ÊòæÁ§∫Á™ÅÁ†¥‰ø°Âè∑',
                        'Âü∫Êú¨Èù¢ÊîØÊíëÊúâÈôê',
                        'Â∏ÇÂú∫ÊÉÖÁª™ÂÅèÂêë‰πêËßÇ',
                        'È£éÈô©ÊéßÂà∂ÈúÄË¶ÅÂä†Âº∫'
                    ]
                },
                debate_summary: 'ÁªèËøáÂ§öËΩÆËæ©ËÆ∫ÔºåÊô∫ËÉΩ‰ΩìËææÊàêË∞®ÊÖé‰πêËßÇÁöÑÂÖ±ËØÜ',
                timestamp: new Date().toISOString()
            };
        }

        async function mockRiskAnalysis(portfolio, confidence) {
            await sleep(1500);
            const stocks = portfolio.split(',').map(s => s.trim());
            return {
                portfolio: stocks,
                confidence_level: confidence,
                var_95: (Math.random() * 0.1 + 0.02).toFixed(4),
                var_99: (Math.random() * 0.15 + 0.05).toFixed(4),
                expected_shortfall: (Math.random() * 0.2 + 0.08).toFixed(4),
                max_drawdown: (Math.random() * 0.25 + 0.1).toFixed(4),
                sharpe_ratio: (Math.random() * 2 + 0.5).toFixed(2),
                correlation_matrix: 'Áõ∏ÂÖ≥ÊÄßÂàÜÊûêÂÆåÊàê',
                stress_test_results: {
                    market_crash: '-15.2%',
                    interest_rate_shock: '-8.7%',
                    sector_rotation: '-6.3%'
                },
                timestamp: new Date().toISOString()
            };
        }

        async function mockAdvancedBacktest(strategy, period) {
            await sleep(2000);
            return {
                strategy: strategy,
                period: period,
                total_return: ((Math.random() * 0.8 - 0.2) * 100).toFixed(2) + '%',
                annualized_return: ((Math.random() * 0.4 - 0.1) * 100).toFixed(2) + '%',
                volatility: (Math.random() * 0.3 + 0.1 * 100).toFixed(2) + '%',
                sharpe_ratio: (Math.random() * 2 + 0.5).toFixed(2),
                max_drawdown: (Math.random() * 0.3 * 100).toFixed(2) + '%',
                win_rate: (Math.random() * 0.4 + 0.4 * 100).toFixed(1) + '%',
                profit_factor: (Math.random() * 2 + 1).toFixed(2),
                trades_count: Math.floor(Math.random() * 200 + 50),
                timestamp: new Date().toISOString()
            };
        }

        async function mockSystemHealthCheck() {
            await sleep(1000);
            return {
                system_status: 'healthy',
                cpu_usage: (Math.random() * 60 + 20).toFixed(1) + '%',
                memory_usage: (Math.random() * 40 + 30).toFixed(1) + '%',
                disk_usage: (Math.random() * 30 + 40).toFixed(1) + '%',
                active_connections: systemMetrics.activeConnections,
                response_time: systemMetrics.avgResponseTime + 'ms',
                uptime: Math.floor(Math.random() * 86400) + ' seconds',
                api_status: {
                    tushare: Math.random() > 0.2 ? 'online' : 'offline',
                    dashscope: Math.random() > 0.3 ? 'online' : 'offline',
                    tavily: Math.random() > 0.4 ? 'online' : 'offline'
                },
                timestamp: new Date().toISOString()
            };
        }

        async function mockPerformanceTest() {
            await sleep(1500);
            return {
                test_type: 'performance_stress_test',
                concurrent_requests: 100,
                avg_response_time: (Math.random() * 200 + 100).toFixed(0) + 'ms',
                success_rate: (Math.random() * 0.1 + 0.9 * 100).toFixed(1) + '%',
                throughput: Math.floor(Math.random() * 500 + 200) + ' req/sec',
                memory_peak: (Math.random() * 200 + 300).toFixed(0) + 'MB',
                cpu_peak: (Math.random() * 40 + 60).toFixed(1) + '%',
                recommendations: [
                    'Á≥ªÁªüÊÄßËÉΩËâØÂ•Ω',
                    'Âª∫ËÆÆÁõëÊéßÂÜÖÂ≠ò‰ΩøÁî®',
                    'ÂèØ‰ºòÂåñÊï∞ÊçÆÂ∫ìÊü•ËØ¢'
                ],
                timestamp: new Date().toISOString()
            };
        }

        async function mockApiConnectionTest() {
            await sleep(800);
            const apis = ['tushare', 'dashscope', 'tavily', 'openai'];
            const results = {};
            
            for (const api of apis) {
                const connected = Math.random() > 0.25;
                results[api] = {
                    status: connected ? 'connected' : 'failed',
                    response_time: connected ? Math.floor(Math.random() * 500 + 100) + 'ms' : 'timeout',
                    last_test: new Date().toISOString()
                };
            }
            
            return {
                test_type: 'api_connection_test',
                results: results,
                overall_status: Object.values(results).every(r => r.status === 'connected') ? 'all_online' : 'partial_online',
                timestamp: new Date().toISOString()
            };
        }

        async function mockClearCache() {
            await sleep(500);
            return {
                operation: 'clear_cache',
                cleared_items: Math.floor(Math.random() * 1000 + 100),
                freed_space: (Math.random() * 100 + 50).toFixed(1) + 'MB',
                cache_types: ['analysis_cache', 'data_cache', 'session_cache'],
                status: 'success',
                timestamp: new Date().toISOString()
            };
        }
    </script>
</body>
</html>